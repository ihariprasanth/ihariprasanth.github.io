<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Technical - HARIPRASANTH T – Portfolio</title>
  <meta name="description" content="HARIPRASANTH T – Computer Science Student & Aspiring Full Stack Developer specializing in web development and e-commerce solutions." />
  <link rel="stylesheet" href="style.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />

<body>
  <!-- Reused page header/nav from index -->

    <header>
      <nav>
        <a href="index.html">Home</a> |
        <a href="Technical.html">Technical</a>
      </nav>
    </header>
    
  <main class="container">
    <section id="technical-hero" class="hero">
      <h1>Technical Profile</h1>
      <p class="lead">LeetCode stats and certifications — same look & theme as the rest of your portfolio.</p>
    </section>

    <section id="leetcode-stats" class="card">
      <h2>LeetCode — <span id="lc-username">ihariprasanth</span></h2>
      <div id="lc-loading">Loading LeetCode stats...</div>
      <div id="lc-stats" style="display:none;">
        <div class="stat-row">
          <div class="stat">
            <div class="stat-number" id="lc-total">0</div>
            <div class="stat-label">Total Solved</div>
          </div>
          <div class="stat">
            <div class="stat-number" id="lc-easy">0</div>
            <div class="stat-label">Easy</div>
          </div>
          <div class="stat">
            <div class="stat-number" id="lc-medium">0</div>
            <div class="stat-label">Medium</div>
          </div>
          <div class="stat">
            <div class="stat-number" id="lc-hard">0</div>
            <div class="stat-label">Hard</div>
          </div>
        </div>
        <p id="lc-additional"></p>
      </div>
      <div class="card-actions">
        <button id="lc-refresh">Refresh</button>
        <a id="lc-profile-link" href="https://leetcode.com/u/ihariprasanth/" target="_blank" rel="noopener">Open LeetCode Profile</a>
      </div>
      <small class="muted">Note: This uses LeetCode's GraphQL endpoint. If the browser blocks cross-origin requests, the page will fall back to a third-party API if available.</small>
    </section>

    <section id="certifications" class="card">
      <h2>Certifications</h2>
      <div id="cert-list">
        <div class="cert-item"><a href="Certifications/Deloitte Job Simulation.pdf" target="_blank" rel="noopener">Deloitte Job Simulation.pdf</a></div>

      </div>
      <p class="muted">You can add more certificates in the <code>Certifications/</code> folder and they'll appear here.</p>
    </section>
  </main>

  <!-- Reuse existing scripts -->
  <script src="script.js"></script>

  <!-- Inline script to fetch LeetCode stats for the username and update the DOM -->
  <script>
  (function(){
    const username = "ihariprasanth";
    const usernameEl = document.getElementById('lc-username');
    const loadingEl = document.getElementById('lc-loading');
    const statsEl = document.getElementById('lc-stats');
    const totalEl = document.getElementById('lc-total');
    const easyEl = document.getElementById('lc-easy');
    const mediumEl = document.getElementById('lc-medium');
    const hardEl = document.getElementById('lc-hard');
    const addEl = document.getElementById('lc-additional');
    const profileLink = document.getElementById('lc-profile-link');
    const refreshBtn = document.getElementById('lc-refresh');

    usernameEl.textContent = username;
    profileLink.href = "https://leetcode.com/" + username + "/";

    // GraphQL query to get submitStatsGlobal (acSubmissionNum)
    const graphqlQuery = {
      query: `query getUserProfile($username: String!) {
        matchedUser(username: $username) {
          username
          submitStats: submitStatsGlobal {
            acSubmissionNum {
              difficulty
              count
            }
          }
          profile {
            reputation
            ranking
          }
        }
      }`,
      variables: { username: username }
    };

    async function fetchWithGraphQL(){
      const resp = await fetch("https://leetcode.com/graphql", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(graphqlQuery),
        credentials: "omit"
      });
      if(!resp.ok) throw new Error("GraphQL request failed with status " + resp.status);
      return await resp.json();
    }

    async function fetchWithThirdParty(){
      // Try a few community-hosted LeetCode stats APIs as fallback
      const endpoints = [
        "https://alfa-leetcode-api.vercel.app/ihariprasanth",
        "https://leetcode-stats-api.herokuapp.com/user/ihariprasanth",
        "https://leetcode-restful-api.vercel.app/ihariprasanth"
      ];
      for(const url of endpoints){
        try{
          const r = await fetch(url);
          if(!r.ok) continue;
          const d = await r.json();
          return { thirdparty: true, data: d };
        }catch(e){
          // ignore and try next
        }
      }
      throw new Error("No third-party API available");
    }

    function applyGraphQLData(data){
      if(!data || !data.data || !data.data.matchedUser) throw new Error("Invalid GraphQL data");
      const arr = data.data.matchedUser.submitStats.acSubmissionNum || [];
      let totals = { total:0, easy:0, medium:0, hard:0 };
      arr.forEach(item=>{
        const key = (item.difficulty||"").toLowerCase();
        if(key === "all" || key === "") totals.total = item.count;
        else totals[key] = item.count;
      });
      // If 'all' not present, sum easy+medium+hard
      if(!totals.total) totals.total = (totals.easy||0) + (totals.medium||0) + (totals.hard||0);
      totalEl.textContent = totals.total;
      easyEl.textContent = totals.easy||0;
      mediumEl.textContent = totals.medium||0;
      hardEl.textContent = totals.hard||0;
      addEl.textContent = "Data fetched from LeetCode GraphQL endpoint.";
    }

    function applyThirdPartyData(d){
      // Try to handle a few possible shapes from community APIs
      // If alfa-leetcode-api: { totalSolved, easySolved, mediumSolved, hardSolved, ... }
      if(d.totalSolved !== undefined){
        totalEl.textContent = d.totalSolved;
        easyEl.textContent = d.easySolved || 0;
        mediumEl.textContent = d.mediumSolved || 0;
        hardEl.textContent = d.hardSolved || 0;
        addEl.textContent = "Data fetched from community API (alfa-leetcode-api or similar).";
        return;
      }
      // Generic fallback: try nested fields
      if(d.data && d.data.matchedUser && d.data.matchedUser.submitStats){
        applyGraphQLData(d);
        return;
      }
      // Unknown shape
      throw new Error("Unrecognized API response shape");
    }

    async function loadStats(){
      loadingEl.style.display = "block";
      statsEl.style.display = "none";
      try{
        // First try direct GraphQL
        const g = await fetchWithGraphQL();
        applyGraphQLData(g);
      }catch(e){
        console.warn("GraphQL failed:", e.message);
        try{
          const third = await fetchWithThirdParty();
          applyThirdPartyData(third.data);
        }catch(e2){
          console.error("Third-party fallback failed:", e2.message);
          loadingEl.innerHTML = "<strong>Error loading LeetCode stats:</strong> " + e2.message + ". You can still open the profile link to view stats directly.";
          return;
        }
      }
      loadingEl.style.display = "none";
      statsEl.style.display = "block";
    }

    refreshBtn.addEventListener('click', loadStats);
    // Load on page start
    loadStats();

  })();
  </script>

</body>
</html>
